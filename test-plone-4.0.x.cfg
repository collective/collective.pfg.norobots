[buildout]
extends =
    http://svn.plone.org/svn/collective/buildout/plonetest/test-4.0.x.cfg
#    http://good-py.appspot.com/release/plone.app.theming/1.0
#    http://good-py.appspot.com/release/plone.app.discussion/1.0
#    http://good-py.appspot.com/release/plone.app.z3cform/0.5.0?plone=4.0.10
#    http://good-py.appspot.com/release/plone.app.registry/1.0b2?plone=4.0.10

eggs-directory = /Users/sbo/.buildout/eggs
download-cache = /Users/sbo/.buildout/downloads
extends-cache = /Users/sbo/.buildout/extends

package-name = collective.pfg.norobots
package-extras = [test]

parts += 
    coverage
    report
    report-xml
    omelette

[instance]
eggs += 
    PILwoTK
    collective.z3cform.norobots
#    plone.app.discussion == 1.1.4
    
[test]
recipe = zc.recipe.testrunner
eggs =
    ${instance:eggs}
#    plone.app.discussion == 1.1.4
#    plone.app.registry
    collective.pfg.norobots [test]
    collective.z3cform.norobots [test]
#    PILwoTK
defaults = ['-s', '${buildout:package-name}', '--auto-color', '--auto-progress']


[coverage]
# generate .coverage file
# use --source to select which eggs to include (reference to a directory)
recipe = zc.recipe.egg
eggs = coverage
initialization =
    include = '--source=${buildout:directory}/src/collective/pfg/norobots'
    sys.argv = sys.argv[:] + ['run', include, 'bin/test', '--all']

[report]
# generate an HTML file in the directory htmlcov
recipe = zc.recipe.egg
eggs = coverage
scripts = coverage=report
initialization =
    sys.argv = sys.argv[:] + ['html', '-i']

[report-xml]
# generate coverage.xml file
recipe = zc.recipe.egg
eggs = coverage
scripts = coverage=report-xml
initialization =
    sys.argv = sys.argv[:] + ['xml', '-i']

[omelette]
recipe = collective.recipe.omelette
eggs = ${instance:eggs}
